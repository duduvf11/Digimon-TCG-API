<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digimon TCG API</title>
</head>
<body>
    <main>
        <h1>Digimon TCG API</h1>
        <button onclick="fetchDigAPI()">Preencher Lista</button>
        <ul id="fill_list"></ul>

        <div>
            <input id="search_input" type="text">
            <button id="search_button" onclick="searchDigAPI()">Buscar</button>
            <ul id="search_list"></ul>
        </div>
    </main>


    <script charset="UTF-8">
        function fetchDigAPI(){
            fetch('https://digimoncard.io/api-public/getAllCards.php?sort=name&series=Digimon Card Game&sortdirection=asc')
            .then(response => response.json())
            .then(data => {
                const list = document.querySelector('#fill_list')
                
                data.map((item) => {
                    const li = document.createElement('li')
        
                    li.setAttribute('id', item.id)
                    li.innerHTML = `${item.name} | ${item.cardnumber}`
                    list.appendChild(li)
                })
            })
        }
        
        function searchDigAPI(){
        
                const value = document.querySelector('#search_input').value
                fetch('https://digimoncard.io/api-public/search.php?n=' + value)
                    .then((res) => res.json())
                    .then((data) => {
                        const search_list = document.querySelector('#search_list')
                            
                        data.map((item) => {
                            const li = document.createElement('li')
        
                            li.setAttribute('id', item.id)
                            li.innerHTML = `name: ${item.name}<br />card number: ${item.cardnumber} <br /> digi_type: ${item.digi_type} <br /> image: ${item.image_url}<br /> <br />`
                            search_list.appendChild(li)
                        })
                        document.querySelector('input').value = ''
                    })
                    .catch((err) => console.log(err));
        }
    </script>
</body>
</html>